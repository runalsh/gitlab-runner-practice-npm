# stages:
#     - build
#     - test
#     - deploy

# maven-build:
#   image: maven:3-jdk-11
#   stage: build
#   script: "mvn package -B"
#   artifacts:
#     paths:
#       - target/gitlab-ci-demo.jar

image: alpine

stages:
  - compile
  - test
  - package

compile:
  stage: compile
  script: 
    - echo "Hello world 1" > file1.txt
    - echo "Hello world 2" > file2.txt
    - cat file1.txt file2.txt > compiled.txt
  artifacts:
    paths:
    - compiled.txt


test:
  stage: test
  script: cat compiled.txt | grep -q 'Hello world'

pack-gz:
  stage: package
  script: cat compiled.txt | gzip > packaged.gz
  artifacts:
    paths:
    - packaged.gz

pack-iso:
  stage: package
  script:
  - mkisofs -o ./packaged.iso ./compiled.txt
  artifacts:
    paths:
    - packaged.iso    